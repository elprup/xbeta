{"id":184,"date":"2006-09-04T21:04:59","date_gmt":"2006-09-04T21:04:59","guid":{"rendered":"http://192.168.5.119/2.2/?p=184"},"modified":"2006-09-04T21:04:59","modified_gmt":"2006-09-04T21:04:59","slug":"ahk-irfanvie","status":"publish","link":"https://xbeta.info/ahk-irfanvie.htm","title":{"rendered":"AutoHotkey｜脚本：用Irfanview把24位真彩图片优化到实际色深"},"content":{"rendered":"<div>; xbeta 2006-09-05 <a href=\"http://blog.sina.com.cn/m/xbeta\">http://blog.sina.com.cn/m/xbeta</a></p>\n<p>;<br />\n考虑到有些抓屏软件png只能24BP真彩色，而实际颜色不过几百或十几，可以减小色深来明显减小文件体积。可以通过本宏和Irfanview来实现。</p>\n<p>;================================================</p>\n<p>; 在IrfanView的窗口模式下（非全屏），按alt+d，脚本会：</p>\n<p>; 先确定颜色数，热键 alt+i+i</p>\n<p>; 再减色：热键 alt+i+d后，根据上一步颜色数确定色深</p>\n<p>; 保存，确认</p>\n<p>;================================================</p>\n<p>;<br />\n请先检查代码！请勿在重要场合测试！<strong>测试前请备份原文件</strong>（本脚本不提醒直接覆盖原文件）</div>\n<div>!d::</p>\n<p>SetTitleMatchMode, 2</p></div>\n<div>; 1 准备</p>\n<p>WinActivate, Irfanview</p></div>\n<div>; 2 查色</p>\n<p>send, {alt}i</p>\n<p>sleep, 20</p>\n<p>send, i</p>\n<p>winwait, IrfanView &#8211; Image properties</p>\n<p>controlgettext, OutputVar, Edit12, IrfanView &#8211; Image<br />\nproperties</p>\n<p>send, {enter}</p></div>\n<div>; 3 减色</p>\n<p>send, {alt}i</p>\n<p>sleep, 20</p>\n<p>send, d</p>\n<p>winwait, Decrease</p></div>\n<div>if OutputVar&lt;3</p>\n<p>; GuiControl, , Button3, 1;;<br />\n无效，只好用下述办法</p>\n<p>send, {alt down}2{alt up}{enter}</p></div>\n<div>else if OutputVar&lt;17</p>\n<p>send, {alt down}1{alt up}{enter}</p>\n<p>else if OutputVar&lt;258</p>\n<p>send, {alt down}5{alt up}{enter}</p>\n<p>else</p>\n<p>{</p>\n<p>send, {esc}</p>\n<p>MsgBox,,,<br />\n&#8220;颜色数为%OutputVar%，保持真彩，未做减色&#8221;, 1.5</p>\n<p>return</p>\n<p>}</p></div>\n<div>; 4 保存</p>\n<p>winwait, IrfanView</p>\n<p>send, s</p>\n<p>winwait, Save</p>\n<p>send, {enter}</p>\n<p>winwait, IrfanView</p>\n<p>send, y</p>\n<p>MsgBox,,, &#8220;恭喜！已按%OutputVar%色优化并保存&#8221;, 1.5</p>\n<p>return</p></div>\n<p>></iframe></p>\n","protected":false},"excerpt":{"rendered":"<p>; xbeta 2006-09-05 http://blog.sina.com.cn/m/xbeta ; 考虑 [&hellip;]</p>\n","protected":false},"author":15,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":["2 图像影音","旧.系统工具","未分类","看图软件"],"tags":["AutoHotkey","IrfanView","all"],"_links":{"self":[{"href":"https://xbeta.info/wp-json/wp/v2/posts/184"}],"collection":[{"href":"https://xbeta.info/wp-json/wp/v2/posts"}],"about":[{"href":"https://xbeta.info/wp-json/wp/v2/types/post"}],"author":[{"embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/users/15"}],"replies":[{"embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/comments?post=184"}],"version-history":[{"count":0,"href":"https://xbeta.info/wp-json/wp/v2/posts/184/revisions"}],"wp:attachment":[{"href":"https://xbeta.info/wp-json/wp/v2/media?parent=184"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/categories?post=184"},{"taxonomy":"post_tag","embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/tags?post=184"}],"curies":[{"name":"wp","href":"https://api.w.org/{rel}","templated":true}]},"wp_type":"post"}