{"id":876,"date":"2009-10-14T17:08:24","date_gmt":"2009-10-14T09:08:24","guid":{"rendered":"http://xbeta.info/?p=876"},"modified":"2009-10-14T17:08:24","modified_gmt":"2009-10-14T09:08:24","slug":"pdf-shrink","status":"publish","link":"https://xbeta.info/pdf-shrink.htm","title":{"rendered":"PDF压缩技巧及PDF压缩软件(再次更新)"},"content":{"rendered":"<p>　　总结一下PDF压缩技巧及相关的PDF压缩软件，作为 <a href=\"http://xbeta.info/pdf-software.htm\">全面接触PDF:最好用的PDF软件汇总</a> 的专门补充。尽管使用 pdf 压缩的机会不多，但考虑到这方面的相关文章和软件介绍极少，所以，写作此文并持续完善。欢迎指正补充。</p>\n<h2>一、PDF内部的压缩技术</h2>\n<p>　　pdf 文件内部已经使用了如下压缩技术：<br />\n　　- LZW (Lempel-Ziv-Welch) 与 FLATE (ZIP, PDF v1.2)：用于图像、文本的无损压缩。<br />\n　　- JPEG 及 JPEG2000 (PDF v1.5)：用于图像的有损和无损压缩。<br />\n　　- CCITT (Group 3 or 4) 与 JBIG2 (PDF v1.4)：用于黑白图像无损压缩。<br />\n　　因此，pdf文件通过压缩软件（7-Zip/WinZip/WinRar）来减小存储体积的做法，通常不会取得明显效果。但必要情况下，也不妨尝试。比如Ni网友留言说，“7-Zip的LZMA算法对某些文件还是有很大压缩效果的，曾试过把50M的PDF用7z压到16M。”</p>\n<h2>二、pdf文件体积的相关因素及压缩技巧<span style=\"color:red;\">｜更新</span></h2>\n<p>　　关于PDF文件的体积与优化。<br />\n　　1. 任何优化（或压缩）都可以分为两种：有损和无损。涉及的信息，既包括能直接看到的文字、图像，也包括不被直接看到的字体、文件元信息等。举个非pdf的例子，从bmp到png的格式转换是无损的，到jpg就是有损的。对jpg优化（有损）而言，一种是降低图像质量，一种是减少头信息。其中比较智能的软件，在降低图像质量时，能对不同区域采取不同的图像压缩比。即：次要区域多压缩多损失，重要区域少压缩保持高质量。<br />\n　　2. pdf如果体积较大，通常是来自图像和嵌入的字体。<br />\n　　3. 生成pdf时就要考虑体积，建议：采用较少的字体，采用常见的字体，这样就可以在减少字体嵌入的成本，而不影响显示质量。减少图片的数量、尺寸、色深，采用最适合的格式。</p>\n<p>　　从文件体积看，可以这样表示：<strong>pdf=文+字体+格式+图+附件</strong>。因此，压缩pdf也要从这些方面入手。</p>\n<h3>PDF的字体优化原则<span style=\"color:red;\">｜更新</span></h3>\n<p>　　字体优化(<a href=\"http://www.aivosto.com/vbtips/pdf-optimize.html\">via</a>)的原则如下：<br />\n　　- 优先使用标准字体。PDF默认的标准字体有5种（Times, Helvetica, Courier, Symbol, ZapfDingbats），规范的pdf阅读器必须支持这些字体。此外的字体就有可能需要全部或部分嵌入（Font Embedding）。<br />\n　　- 使用较少种类的字体。若要体积小，就不要宋体、楷体、黑体一齐来了。另外，滥用字体会远离美观而偏向花哨甚至恶俗。<br />\n　　- 使用较少的字体风格。对pdf而言，常规、粗体、斜体、粗斜体是4种不同的字体，需要分别嵌入。少用一种是一种。另外，这些字体强调方式，可以换用字号、颜色、下划线、字符间距、缩进等手段实现，它们不会占用多余体积。<br />\n　　- 使用轻型字体。（比如某些华丽的艺术字体，比常规的黑体、宋体体积更大）。</p>\n<h3>PDF的图像优化</h3>\n<p>　　待完成……</p>\n<h3>通常有效的PDF优化措施<span style=\"color:red;\">｜更新</span></h3>\n<p>　　- 用 PDF 打印软件把pdf文件再打印为新的pdf；（<strong>推荐一试</strong>，因为有大量免费软件！）<br />\n　　- 在 PDF 编辑软件中“另存为” 。解释：pdf是一种“增量保存（incremental updates）”格式。当你改变一些信息后，它会将这种变化“保存”在原文件的最后，这种做法速度快，但文件体积大。而“另存”则是重写文件内容，速度稍慢，但文件体积减小。<br />\n　　- 高级PDF编辑软件中的优化按钮。如 Nitro PDF Button → Prepare → Optimize Document；如Acrobat 8 → Advanced → PDF Optimizer.</p>\n<h3>更多PDF优化资料<span style=\"color:red;\">｜更新</span></h3>\n<p>　　<a href=\"http://www.verypdf.com/pdfinfoeditor/optimize-pdf-file.htm\" title=\" Optimizing your PDF files\"> Optimizing your PDF files</a><br />\n　　<a href=\"\" title=\"http://www.websiteoptimization.com/speed/tweak/pdf/\">Optimize PDF Files</a><br />\n　　<a href=\"http://www.planetpdf.com/enterprise/article.asp?ContentID=6112\">Reducing PDF File Size</a><br />\n　　<br />\n　　oversky网友留言 2009-09-27：pdf creator, cutepdf, PrimoPDF, PDF ReDirect, Bullzip 这样都是用 ghostscript 来生成 pdf。档案大小、品质会有差都是因为设定的关系。主要是在图案的 jpeg 压缩比、解析度较高的图案是否有 downsampling，还有字型是否有包入 pdf 档有关。真要说可以制作比较小的档案，要找可以把图用 jpeg2000 压的，目前我只看到 PDF-XCHANGE 4 PRO 和 adobe acrobat 有这技术。</p>\n<h2>三、pdf 压缩软件综述</h2>\n<h3>免费PDF压缩软件<span style=\"color:red;\">｜更新</span></h3>\n<p>　　免费pdf压缩软件几乎不存在。很多早期免费的pdf压缩软件都在版本升级后转成了收费软件，不再提供免费版本，只能自行搜索。<br />\n　　- PDF Compress v1.0 免费版：出自 bureausoft 公司，免费版可在 <a href=\"http://www.brothersoft.com/pdf-compress-download-28958.html\" title=\"PDF Compress v1.0 免费版\">这里</a> 下载注意<strong>不要</strong>选择官方链接（Official Download），只有选择下载站未更新的链接，才是旧的免费版（2009-10-15测试通过）。最新版本注册价格为 49 USD。<br />\n　　- Free PDF Compressor：旧的免费版未找到下载链接（欢迎提供），新版为 Nice PDF Compressor（59 usd）。</p>\n<h3>收费PDF压缩软件</h3>\n<p>　　多数pdf解决方案供应商都有类似专门软件（verypdf/Advanced PDF Tools/<a href=\"http://www.verypdf.com/pdfinfoeditor/pdf-compress.html\">PDF Compress</a>；）或全能软件中包含了压缩功能（acrobat）。</p>\n<h2>四、压缩软件 PDF Shrink 试用手记</h2>\n<p>　　<img decoding=\"async\" src=\"http://www.apagoinc.com/images/logos/pdf_shrink_bg.gif\" alt=\"pdf shrink\" style=\"float:left\"/><a href=\"http://www.apagoinc.com/prod_home.php?prod_id=30\">PDF Shrink</a>：原Mac平台的pdf压缩软件，现开始提供windows和iPhone版本。试用期 10天，注册价格：35usd。2009年10月，善用佳软得到了 PDF Shrink 的 windows 内测版本，试用如下。</p>\n<h3>1. 下载安装与试用</h3>\n<p>　　<strong>下载</strong>：PDFshrink_w45.exe 约3.5MB。<br />\n　　<strong>安装</strong>：安装后 9.3MB，包括如下文件：</p>\n<table border=\"1\" cellspacing=\"1\" cellpadding=\"5\">\n<tr>\n<td>\nPDFShrink.exe<br />\nPDF Shrink Users Guide.pdf<br />\nwebupdater.exe<br />\nApago PDF Shrink.url<br />\nlicense.txt<br />\nuninst.exe<br />\nwebupdatedlg.xrc\n</td>\n<td>\n6,824 KB<br />\n540 KB<br />\n1,920 KB<br />\n1 KB<br />\n1 KB<br />\n49 KB<br />\n33 KB\n</td>\n</tr>\n</table>\n<p>　　<strong>运行主程序</strong>，PDFShrink.exe，其界面与基本功能可通过下面的<a href=\"http://v.youku.com/v_show/id_XMTI1MjU1NTY4.html\">视频</a> （抱歉，不太清晰）有个基本了解。<br />\n<embed src='http://player.youku.com/player.php/sid/XMTI1MjU1NTY4/v.swf' quality='high' width='480' height='400' align='middle' allowScriptAccess='sameDomain' type='application/x-shockwave-flash'></embed><br />\n　　软件的基本界面很简单，主界面的列表是几个预设压缩方案。直接把pdf文件拖放到对应方案上即可。</p>\n<h3>2. PDF Shrink 压缩原理</h3>\n<p>　　PDF Shrink Users Guide.pdf 中提到，“PDF Shrink reduces the size of PDF files by optimizing the resolution and compression method of each image in the PDF file. The interface allows for setting different compression and resolution choices for color, grayscale and monochrome images.”<br />\n　　照此来说，PDF Shrink 的优化措施只是在图片方面：优化（应该就是降低）分辨率、改进压缩算法。而不涉及影响到pdf大小的其他方面（比如字体嵌入）。</p>\n<h3>3. 纯文本pdf压缩测试</h3>\n<p>原始文件：雪山飞狐.txt，ansi编码 264KB。<br />\n测试过程：用notepad.exe打印到如下三款pdf打印机（采用默认设置），然后，用 PDF Shrink 的 web 方案进行压缩。<br />\n测试结果：</p>\n<table border=\"1\" cellspacing=\"1\" cellpadding=\"5\">\n<tr>\n<th>生成软件</th>\n<th>初始pdf大小</th>\n<th>PDF Shrink后</th>\n<th>压缩率</th>\n</tr>\n<tr>\n<td>PDFCreator</td>\n<td>825 KB</td>\n<td>800 KB</td>\n<td>3.0%</td>\n</tr>\n<tr>\n<td>PDFCreator-优化*</td>\n<td>417 KB</td>\n<td>375 KB</td>\n<td>5.3%</td>\n</tr>\n<tr>\n<td>CutePDF Writer</td>\n<td>1080 KB</td>\n<td>1055 KB</td>\n<td>2.2%</td>\n</tr>\n<tr>\n<td>TinyPDF</td>\n<td>982 KB</td>\n<td>950 KB</td>\n<td>3.3%</td>\n</tr>\n</table>\n<p>* PDFCreator-优化：手工设置不嵌入字体。</p>\n<p>结论：<br />\n　　PDF Shrink 对文字内容几乎无法压缩。不嵌入字体是减少文本类型PDF体积的有效手段。</p>\n<h3>4. 纯图像pdf压缩测试</h3>\n<p>原始文件：photo.doc。制作过程：直接在 MS Word 2003 中 ctrl+n 新建文档，在TC中拖放3图片文件（数码相机照片，jpg，3888 x 2592 像素，每张约 3MB，共 9.7MB）到该doc文档，保存，得 doc 文件 10.3 MB。分别打印到如下三款pdf打印机（采用默认设置），然后，用 PDF Shrink 的 web 方案进行压缩。<br />\n测试结果：</p>\n<table border=\"1\" cellspacing=\"1\" cellpadding=\"5\">\n<tr>\n<th>生成软件</th>\n<th>初始pdf大小</th>\n<th>PDF Shrink后</th>\n<th>压缩率</th>\n</tr>\n<tr>\n<td>PDFCreator</td>\n<td>1634 KB</td>\n<td>39 KB</td>\n<td>97%</td>\n</tr>\n<tr>\n<td>PDFCreator-优化*</td>\n<td>49 KB</td>\n<td>42 KB</td>\n<td>15%</td>\n</tr>\n<tr>\n<td>CutePDF Writer</td>\n<td>2182 KB</td>\n<td>39 KB</td>\n<td>98%</td>\n</tr>\n<tr>\n<td>TinyPDF</td>\n<td>837 KB</td>\n<td>210 KB</td>\n<td>75%</td>\n</tr>\n</table>\n<p>* PDFCreator-优化：手工设置pdf分辨率，从默认600降到72；彩色图像压缩从默认自动改为 jpeg 最大压缩，并设分辨率为72。</p>\n<p>结论：<br />\n　　① 总体看，大尺寸图像的压缩，从doc到pdf，再到压缩后的pdf，都有明显效果。本例：10MB → 1-2MB → 50KB。<br />\n　　② CutePDF Writer 和 PDFCreator 生成的原始文件相差较多，但压缩后的体积相同。这是因为本质上它们都是用 ghostscript 生成的。<br />\n　　③ 基于 GhostScript 的 PDF 生成，可以通过参数设置降低文件大小。比如 PDFCreator 更改设置后直接生成的 pdf 为49KB，但比起 PDF Shrink 压缩出的更小（39KB）的pdf，图像质量较差。</p>\n<h3>5. 实际网页测试</h3>\n<p>原始文件：在 Chrome 浏览器中打开 http://xbeta.info 页面，分别打印到如下三款pdf打印机（采用默认设置），然后，用 PDF Shrink 的 web 方案进行压缩。<br />\n测试结果：</p>\n<table border=\"1\" cellspacing=\"1\" cellpadding=\"5\">\n<tr>\n<th>生成软件</th>\n<th>初始pdf大小</th>\n<th>PDF Shrink后</th>\n<th>压缩率</th>\n</tr>\n<tr>\n<td>PDFCreator</td>\n<td>203 KB</td>\n<td>189 KB</td>\n<td>5%</td>\n</tr>\n<tr>\n<td>CutePDF Writer</td>\n<td>289 KB</td>\n<td>271 KB</td>\n<td>4%</td>\n</tr>\n<tr>\n<td>TinyPDF</td>\n<td>188 KB</td>\n<td>167 KB</td>\n<td>9%</td>\n</tr>\n</table>\n<p>结论：<br />\n　　① pdf压缩效果取决于图像/文字的比例。<br />\n　　② 对于本身体积较小的pdf文件，最终大小首先取决于生成时的设置，其次才是压缩。比如，本例中，用tiny pdf生成的原始文件，比压缩后的cuteppdf、pdfcreator文件更小。</p>\n<p>　　大家如有其他关心问题，欢迎留言提出。</p>\n<h3 id=\"update-history\">附录：文章更新历史</h3>\n<p>　　2009-10-15：补充PDF优化方法与建议；更正链接/错字，鸣谢黯然过客、ivanlee。<br />\n　　2009-10-14：新增纯文本、纯图片测试案例。<br />\n　　2009-10-14：初稿。<br />\n></iframe></p>\n","protected":false},"excerpt":{"rendered":"<p>　　总结一下PDF压缩技巧及相关的PDF压缩软件，作为 全面接触PDF:最好用的PDF软件汇总 的专门补充。尽 [&hellip;]</p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":["1 文本办公","PDF","未分类"],"tags":["PDF","all"],"_links":{"self":[{"href":"https://xbeta.info/wp-json/wp/v2/posts/876"}],"collection":[{"href":"https://xbeta.info/wp-json/wp/v2/posts"}],"about":[{"href":"https://xbeta.info/wp-json/wp/v2/types/post"}],"author":[{"embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/users/2"}],"replies":[{"embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/comments?post=876"}],"version-history":[{"count":0,"href":"https://xbeta.info/wp-json/wp/v2/posts/876/revisions"}],"wp:attachment":[{"href":"https://xbeta.info/wp-json/wp/v2/media?parent=876"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/categories?post=876"},{"taxonomy":"post_tag","embeddable":true,"href":"https://xbeta.info/wp-json/wp/v2/tags?post=876"}],"curies":[{"name":"wp","href":"https://api.w.org/{rel}","templated":true}]},"wp_type":"post"}